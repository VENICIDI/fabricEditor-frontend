
<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fabric.js 画布编辑器 MVP</title>
    <link rel="stylesheet" href="./editor.css" />
  </head>
  <body>
    <div class="app">
      <nav class="left-toolbar" aria-label="工具" id="leftToolbar">
        <div class="tool-group">
          <button class="tool-btn" id="btnSelectMode" aria-pressed="true" data-tooltip="选择">
            <img class="tool-svg" src="./svg/select.svg" alt="" aria-hidden="true" />
          </button>

          <button class="tool-btn tool-btn--has-menu" id="btnShape" aria-pressed="false" data-tooltip="形状">
            <img class="tool-svg" src="./svg/rectangle.svg" alt="" aria-hidden="true" />
          </button>

          <button class="tool-btn" id="btnText" aria-pressed="false" data-tooltip="文本">
            <img class="tool-svg" src="./svg/text.svg" alt="" aria-hidden="true" />
          </button>
        </div>

        <div class="tool-sep" role="separator"></div>

        <div class="tool-group">
          <button class="tool-btn" id="btnBrush" aria-pressed="false" data-tooltip="画笔">
            <img class="tool-svg" src="./svg/pen.svg" alt="" aria-hidden="true" />
          </button>
          <button class="tool-btn" id="btnEraser" aria-pressed="false" data-tooltip="橡皮擦">
            <img class="tool-svg" src="./svg/erase.svg" alt="" aria-hidden="true" />
          </button>
        </div>

        <div class="tool-sep" role="separator"></div>

        <div class="tool-group tool-group--bottom"></div>

        <div class="tool-popover" id="shapeMenu" role="menu" hidden>
          <button class="tool-menu-item" id="btnRect" role="menuitem" data-tooltip="矩形">
            <img class="tool-svg" src="./svg/rectangle.svg" alt="" aria-hidden="true" />
            <span>矩形</span>
          </button>
          <button class="tool-menu-item" id="btnCircle" role="menuitem" data-tooltip="圆形">
            <img class="tool-svg" src="./svg/circle.svg" alt="" aria-hidden="true" />
            <span>圆形</span>
          </button>
        </div>

        <div class="tool-popover" id="brushMenu" role="menu" hidden>
          <div class="tool-menu-row">
            <label for="brushColor">颜色</label>
            <input id="brushColor" type="color" value="#111111" />
          </div>
          <div class="tool-menu-row">
            <label for="brushWidth">线宽</label>
            <input id="brushWidth" type="number" min="1" step="1" value="4" />
          </div>
          <div class="tool-menu-row">
            <label for="brushOpacity">透明度</label>
            <input id="brushOpacity" type="number" min="0" max="1" step="0.05" value="1" />
          </div>
        </div>
      </nav>

      <main class="canvas-shell" aria-label="画布">
        <div class="top-toolbar" aria-label="编辑">
          <div class="top-toolbar-group">
            <button class="top-btn" id="btnUndo" data-tooltip="撤销">
              <img class="tool-svg" src="./svg/undo.svg" alt="" aria-hidden="true" />
            </button>
            <button class="top-btn" id="btnRedo" data-tooltip="重做">
              <img class="tool-svg" src="./svg/redo.svg" alt="" aria-hidden="true" />
            </button>
          </div>

          <div class="top-toolbar-sep" role="separator"></div>

          <div class="top-toolbar-group">
            <button class="top-btn" id="btnCopy" data-tooltip="复制">
              <img class="tool-svg" src="./svg/copy.svg" alt="" aria-hidden="true" />
            </button>
            <button class="top-btn" id="btnPaste" data-tooltip="粘贴">
              <img class="tool-svg" src="./svg/paste.svg" alt="" aria-hidden="true" />
            </button>
            <button class="top-btn" id="btnDelete" data-tooltip="删除">
              <img class="tool-svg" src="./svg/delete.svg" alt="" aria-hidden="true" />
            </button>
          </div>

          <span class="top-toolbar-spacer"></span>

          <div class="top-toolbar-group">
            <button class="top-btn" id="btnExport" data-tooltip="导出">
              <img class="tool-svg" src="./svg/export.svg" alt="" aria-hidden="true" />
            </button>
            <button class="top-btn" id="btnImport" data-tooltip="导入">
              <img class="tool-svg" src="./svg/import.svg" alt="" aria-hidden="true" />
            </button>
          </div>
        </div>
        <div class="canvas-wrap" id="canvasContainer">
          <canvas id="c"></canvas>
        </div>
      </main>

      <div class="right-panels" aria-label="右侧面板">
        <section class="panel" aria-label="图层">
          <div class="panel-header">
            <span>图层</span>
            <span class="hint">双击重命名</span>
          </div>
          <div class="panel-body" id="layers"></div>
        </section>

        <section class="panel" aria-label="属性">
          <div class="panel-header">
            <span>属性</span>
            <span class="hint" id="selectionMeta"></span>
          </div>
          <div class="panel-body">
            <div class="row">
              <label for="fill">填充</label>
              <input id="fill" type="color" value="#3b82f6" />
            </div>
            <div class="row">
              <label for="stroke">描边</label>
              <input id="stroke" type="color" value="#111827" />
            </div>
            <div class="row">
              <label for="strokeWidth">描边宽度</label>
              <input id="strokeWidth" type="number" min="0" step="1" value="2" />
            </div>
            <div class="row">
              <label for="opacity">透明度</label>
              <input id="opacity" type="number" min="0" max="1" step="0.05" value="1" />
            </div>

            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 14px 0" />

            <div class="row">
              <label for="text">文本</label>
              <input id="text" type="text" placeholder="仅对文本对象生效" />
            </div>
            <div class="row">
              <label for="fontSize">字号</label>
              <input id="fontSize" type="number" min="6" step="1" value="32" />
            </div>
            <div class="hint">
              快捷键： <span class="kbd">⌘Z</span>/<span class="kbd">Ctrl+Z</span> 撤销，
              <span class="kbd">⌘Y</span>/<span class="kbd">Ctrl+Y</span> 重做， <span class="kbd">⌫</span> 删除，
              <span class="kbd">⌘C</span>/<span class="kbd">Ctrl+C</span> 复制，
              <span class="kbd">⌘V</span>/<span class="kbd">Ctrl+V</span>
              粘贴。
            </div>
          </div>
        </section>
      </div>
    </div>

    <dialog id="jsonModal">
      <div class="modal-header">
        <strong id="jsonModalTitle">JSON</strong>
        <button id="btnCloseModal">关闭</button>
      </div>
      <div class="modal-body">
        <textarea id="jsonTextarea" rows="18" spellcheck="false"></textarea>
      </div>
      <div class="modal-actions">
        <button id="btnConfirmModal" class="primary">确定</button>
      </div>
    </dialog>

    <script src="https://cdn.jsdelivr.net/npm/fabric@latest/dist/index.min.js"></script>
    <script type="module" src="./src/main.js"></script>
  </body>
</html>
